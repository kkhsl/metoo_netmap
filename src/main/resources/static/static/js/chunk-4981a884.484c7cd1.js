(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4981a884"],{"24b4":function(t,e,s){"use strict";s.d(e,"d",(function(){return i})),s.d(e,"e",(function(){return n})),s.d(e,"f",(function(){return r})),s.d(e,"a",(function(){return o})),s.d(e,"b",(function(){return c})),s.d(e,"c",(function(){return u}));var a=s("b775");function i(t){return Object(a["a"])({url:"/admin/gather/type",method:"get",params:t})}function n(t){return Object(a["a"])({url:"/admin/gather/main",method:"get",params:t})}function r(t){return Object(a["a"])({url:"/admin/gather/stop",method:"post",data:t})}function o(t){return Object(a["a"])({url:"/admin/sureying/log",method:"get",params:t})}function c(t){return Object(a["a"])({url:"/admin/sureying/log/single/segment",method:"get",params:t})}function u(t){return Object(a["a"])({url:"/admin/gather/log/status",method:"get",params:t})}},"3bb4":function(t,e,s){"use strict";s.r(e);var a=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-card",{scopedSlots:t._u([{key:"header",fn:function(){return[s("div",{staticClass:"clearfix"},[s("span",{staticStyle:{"line-height":"28px"}},[t._v("测绘日志")]),s("div",{staticClass:"fr"},[s("el-button",{attrs:{size:"small",type:"primary",disabled:t.isRunning},on:{click:t.handBtn}},[t.isRunning?s("span",[s("i",{staticClass:"el-icon-loading"}),t._v(" 测绘中...")]):s("span",[t._v("开始测绘")])]),s("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.noTestRow,expression:"!noTestRow"}],attrs:{size:"small",type:"success"},on:{click:function(e){t.viewDialogFlag=!0}}},[t._v("测绘结果")])],1)])]},proxy:!0}])},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.startLoading,expression:"startLoading"}],staticClass:"logWrap fz12"},[t._l(t.logList,(function(e){return[s("div",{key:e.id,staticClass:"logItem"},[s("div",{staticClass:"flexBox"},[4==e.type?[s("div",{staticClass:"logContent"},[s("div",{staticClass:"logMsg"},[s("div",[t._v(t._s(e.name))])])])]:s("div",{staticClass:"logContent"},[s("div",{staticClass:"logMsg"},[s("p",[t._v(t._s(e.name))]),s("div",{staticClass:"time"},[s("span",[t._v(t._s(e.beginTime))]),t._v(" ~ "),s("span",[s("span",{directives:[{name:"show",rawName:"v-show",value:1===e.status,expression:"item.status === 1"}],staticClass:"successC"},[s("i",{staticClass:"el-icon-loading"}),s("span",{staticClass:"fz12"},[t._v(t._s("数据上传"===e.name?"数据上传中...":"分析中..."))])]),t._v(" "+t._s(e.endTime)+" ")])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:2===e.status,expression:"item.status === 2"}],staticClass:"dot green"},[t._v("成功")]),s("div",{directives:[{name:"show",rawName:"v-show",value:3===e.status,expression:"item.status === 3"}],staticClass:"dot red"},[t._v("失败")])]),s("div",{staticClass:"actions"})],2),e.subLogs?s("div",{staticClass:"subLogWrap p-l-10"},t._l(e.subLogs,(function(e){return s("div",{key:e.id,staticClass:"logContent"},[s("div",{staticClass:"logMsg"},[s("p",{staticStyle:{color:"#7b7b7bbf","text-align":"center"}},[t._v(t._s(e.name))]),s("div",{staticClass:"time"},[s("span",[t._v(t._s(e.beginTime))]),t._v(" ~ "),s("span",[s("span",{directives:[{name:"show",rawName:"v-show",value:1===e.status,expression:"subItem.status === 1"}],staticClass:"successC"},[s("i",{staticClass:"el-icon-loading"}),s("span",{staticClass:"fz12"},[t._v(t._s("数据上传"===e.name?"数据上传中...":"分析中..."))])]),t._v(" "+t._s(e.endTime)+" ")])])]),s("div",{directives:[{name:"show",rawName:"v-show",value:2===e.status,expression:"subItem.status === 2"}],staticClass:"dot green"},[t._v("成功")]),s("div",{directives:[{name:"show",rawName:"v-show",value:3===e.status,expression:"subItem.status === 3"}],staticClass:"dot red"},[t._v("失败")])])})),0):t._e()])]})),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.isRunning&&t.logList.length,expression:"!isRunning && logList.length"}],staticClass:"logItem flexBox"},[s("div",{staticClass:"logContent"},[s("div",{staticClass:"logMsg"},[s("p",[t._v("测绘完成")])])])])],2),s("el-dialog",{attrs:{"close-on-click-modal":!1,title:"测绘结果","custom-class":"mw600 smTank",visible:t.viewDialogFlag,width:"80%",top:"20%"},on:{"update:visible":function(e){t.viewDialogFlag=e},open:t.getAsyncList}},[s("div",{directives:[{name:"loading",rawName:"v-loading",value:t.detailIsLoading,expression:"detailIsLoading"}]},[s("fieldset",{staticClass:"m-b-10"},[s("legend",[t._v("终端统计")]),s("el-descriptions",{staticClass:"fz12",attrs:{column:1}},[s("el-descriptions-item",{attrs:{label:"IPv4终端"}},[t._v(t._s(t.rowDetail.ipv4))]),s("el-descriptions-item",{attrs:{label:"IPv4/IPv6终端"}},[t._v(t._s(t.rowDetail.ipv4_ipv6))])],1)],1)])])],1)},i=[],n=s("c7eb"),r=s("1da1"),o=(s("4de4"),s("d3b7"),s("24b4")),c=s("ae6f"),u={props:{configList:{type:Array,default:function(){return[]}}},data:function(){return{noTestRow:!1,viewTablePost:{currentPage:1,pageSize:15},isRunning:!1,startLoading:!1,logTimer:null,logList:[],viewDialogFlag:!1,defaultProps:{children:"subnetList",label:"ip"},detailIsLoading:!1,rowDetail:{result:"",ipv4:"",ipv4_ipv6:"",subme_ipv4:[],subme_ipv6:[],gatewayInfo:[]}}},watch:{configList:{handler:function(t){var e=this.configList.filter((function(t){return 1==t.deviceVendorSequence}));this.noTestRow=e.length>0,console.log(this.noTestRow)},deep:!0}},mounted:function(){this.getCaiJiStatus(),this.getAsyncList()},methods:{getCaiJiStatus:function(){var t=this;return Object(r["a"])(Object(n["a"])().mark((function e(){var s,a;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["e"])({type:1});case 2:if(s=e.sent,1002!==s.code){e.next=8;break}t.isRunning=!0,t.getLogList(),e.next=13;break;case 8:return e.next=10,Object(o["a"])();case 10:a=e.sent,200==a.code&&a.data&&(t.logList=a.data.data),t.isRunning=!1;case 13:case"end":return e.stop()}}),e)})))()},stopBtn:function(){var t=this;return Object(r["a"])(Object(n["a"])().mark((function e(){var s;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["f"])();case 2:s=e.sent,200===s.code?(t.logTimer&&clearTimeout(t.logTimer),t.getCaiJiStatus(),t.$message.success("停止成功")):t.$message.error(s.msg);case 4:case"end":return e.stop()}}),e)})))()},handBtn:function(){var t=this;return Object(r["a"])(Object(n["a"])().mark((function e(){return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.isRunning){e.next=2;break}return e.abrupt("return",t.$message({message:"正在采集中... 请勿重复提交",type:"warning"}));case 2:Object(o["e"])(),setTimeout((function(){t.getCaiJiStatus()}),500);case 4:case"end":return e.stop()}}),e)})))()},getLogList:function(){var t=this;return Object(r["a"])(Object(n["a"])().mark((function e(){var s;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["a"])();case 2:if(s=e.sent,200!=s.code||!s.data){e.next=13;break}if(t.logList=s.data.data,!s.data.finish){e.next=10;break}return t.isRunning=!1,e.abrupt("return");case 10:t.isRunning=!0,t.logTimer&&clearTimeout(t.logTimer),t.logTimer=setTimeout((function(){t.getLogList()}),2e3);case 13:t.startLoading=!1;case 14:case"end":return e.stop()}}),e)})))()},getAsyncList:function(){var t=this;return Object(r["a"])(Object(n["a"])().mark((function e(){var s,a,i;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.detailIsLoading=!0,e.next=3,Object(c["a"])(t.viewTablePost);case 3:s=e.sent,200==s.code&&s.data&&(a=s.data.obj[0]||{},i=a.details&&"string"===typeof a.details?JSON.parse(a.details):{},t.rowDetail.result=a.result,t.rowDetail.ipv4=i.ipv4,t.rowDetail.ipv4_ipv6=i.ipv4_ipv6,t.rowDetail.subme_ipv4=i.subme_ipv4&&"string"===typeof i.subme_ipv4?JSON.parse(i.subme_ipv4):[],t.rowDetail.subme_ipv6=i.subme_ipv6&&"string"===typeof i.subme_ipv6?JSON.parse(i.subme_ipv6):[],t.rowDetail.gatewayInfo=i.gatewayInfo),t.detailIsLoading=!1;case 6:case"end":return e.stop()}}),e)})))()}}},l=u,d=(s("b6b0"),s("2877")),v=Object(d["a"])(l,a,i,!1,null,"7af036ef",null);e["default"]=v.exports},aaca:function(t,e,s){},ae6f:function(t,e,s){"use strict";s.d(e,"a",(function(){return i}));var a=s("b775");function i(t){return Object(a["a"])({url:"/admin/gather/log/list",method:"post",data:t})}},b6b0:function(t,e,s){"use strict";s("aaca")}}]);
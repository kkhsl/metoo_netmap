(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3e29c0b8"],{"2f54":function(e,t,s){"use strict";s.r(t);var a=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[s("el-card",{directives:[{name:"show",rawName:"v-show",value:!e.authorized,expression:"!authorized"}],scopedSlots:e._u([{key:"header",fn:function(){return[s("div",{staticClass:"clearfix"},[s("span",{staticStyle:{"line-height":"28px"}},[e._v("授权设置")]),s("div",{staticClass:"fr"},[s("el-button",{attrs:{size:"small",type:"info"},on:{click:function(t){return e.$router.push({path:"/"})}}},[e._v("返回首页")])],1)])]},proxy:!0}])},[s("el-form",{attrs:{size:"mini","label-width":"100px",model:e.authFrom,rules:e.rules}},[s("el-form-item",{attrs:{label:"SN 码:"}},[e._v(e._s(e.authFrom.code))]),s("el-form-item",{attrs:{label:"单位:",prop:"unit_id"}},[s("el-cascader",{staticClass:"selectUnitInput",staticStyle:{width:"100%"},attrs:{placeholder:"请选择单位","popper-class":"selectUnit",options:e.unitSelectArr,props:{label:"name",value:"id",children:"subAreas",emitPath:!1},filterable:""},on:{change:e.handleCascaderChange},model:{value:e.authFrom.unit_id,callback:function(t){e.$set(e.authFrom,"unit_id",t)},expression:"authFrom.unit_id"}})],1),s("el-form-item",{attrs:{prop:"sqm",label:"授权申请码"}},[s("el-input",{attrs:{placeholder:"选中单位自动获取申请码",type:"text",clearable:"","auto-complete":"off",size:"mini"},model:{value:e.authFrom.sqm,callback:function(t){e.$set(e.authFrom,"sqm","string"===typeof t?t.trim():t)},expression:"authFrom.sqm"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-copy-document"},on:{click:function(t){return e.copyBtn(e.authFrom.sqm)}},slot:"append"},[e._v("复制")])],1)],1)],1),s("el-form",{ref:"authLicenseForm",attrs:{size:"mini","label-width":"100px",model:e.authLicenseForm,rules:e.authLicenseFormRules}},[s("el-form-item",{attrs:{prop:"code",label:"授权码"}},[s("el-input",{attrs:{autosize:{minRows:5,maxRows:10},placeholder:"请输入授权码，授权码由授权申请码生成",type:"textarea",clearable:"","auto-complete":"off",size:"mini"},model:{value:e.authLicenseForm.code,callback:function(t){e.$set(e.authLicenseForm,"code","string"===typeof t?t.trim():t)},expression:"authLicenseForm.code"}})],1)],1),s("div",{staticClass:"flexCC"},[s("el-button",{attrs:{type:"success"},on:{click:e.confirmAuth}},[e._v("授权")])],1)],1),s("el-card",{directives:[{name:"show",rawName:"v-show",value:e.authorized,expression:"authorized"}],scopedSlots:e._u([{key:"header",fn:function(){return[s("div",{staticClass:"clearfix"},[s("span",{staticStyle:{"line-height":"28px"}},[e._v("授权信息")]),s("div",{staticClass:"fr"},[s("el-button",{attrs:{size:"small",type:"info"},on:{click:function(t){return e.$router.push({path:"/"})}}},[e._v("返回首页")])],1)])]},proxy:!0}])},[s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{xs:12,sm:8,md:6}},[s("el-card",{staticClass:"licenItem"},[s("p",{staticClass:"i_title"},[e._v("版本")]),s("p",{staticClass:"i_value"},[e._v(e._s(e.licenseInfo.licenseVersion))])])],1),s("el-col",{attrs:{xs:12,sm:8,md:6}},[s("el-card",{staticClass:"licenItem"},[s("p",{staticClass:"i_title"},[e._v("地市")]),s("p",{staticClass:"i_value"},[e._v(e._s(e.licenseInfo.city))])])],1),s("el-col",{attrs:{xs:12,sm:8,md:6}},[s("el-card",{staticClass:"licenItem"},[s("p",{staticClass:"i_title"},[e._v("县区")]),s("p",{staticClass:"i_value"},[e._v(e._s(e.licenseInfo.area))])])],1),s("el-col",{attrs:{xs:12,sm:8,md:6}},[s("el-card",{staticClass:"licenItem"},[s("p",{staticClass:"i_title"},[e._v("单位名称")]),s("p",{staticClass:"i_value"},[e._v(e._s(e.licenseInfo.unit))])])],1),s("el-col",{attrs:{xs:12,sm:8,md:6}},[s("el-card",{staticClass:"licenItem"},[s("p",{staticClass:"i_title"},[e._v("开始时间")]),s("p",{staticClass:"i_value"},[e._v(e._s(e.parseTime(e.licenseInfo.startTime)))])])],1),s("el-col",{attrs:{xs:12,sm:8,md:6}},[s("el-card",{staticClass:"licenItem"},[s("p",{staticClass:"i_title"},[e._v("截止时间")]),s("p",{staticClass:"i_value"},[e._v(e._s(e.parseTime(e.licenseInfo.endTime)))])])],1),s("el-col",{attrs:{xs:12,sm:8,md:6}},[s("el-card",{staticClass:"licenItem"},[s("p",{staticClass:"i_title"},[e._v("授权天数")]),s("p",{staticClass:"i_value"},[e._v(e._s(e.licenseInfo.licenseDay))])])],1),s("el-col",{attrs:{xs:12,sm:8,md:6}},[s("el-card",{staticClass:"licenItem"},[s("p",{staticClass:"i_title"},[e._v("剩余天数")]),s("p",{staticClass:"i_value"},[e._v(e._s(e.licenseInfo.surplusDay))])])],1)],1)],1)],1)},n=[],i=s("c7eb"),r=s("1da1"),c=(s("d3b7"),s("159b"),s("cbcf")),o=s("ed08"),l={data:function(){return{loading:!1,authorized:!0,licenseInfo:{},authFrom:{code:"",unit_id:"",sqm:""},authLicenseForm:{code:""},unitSelectArr:[],rules:{unit_id:[{required:!0,message:"单位不能为空",trigger:"blur"}]},authLicenseFormRules:{code:[{required:!0,message:"授权码不能为空",trigger:"blur"}],sqm:[{required:!0,message:"授权申请码不能为空",trigger:"blur"}]}}},mounted:function(){this.getLicenseInfo()},methods:{parseTime:o["b"],getUnitInfo:function(){var e=this;return Object(r["a"])(Object(i["a"])().mark((function t(){var s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["e"])();case 2:s=t.sent,200==s.code&&(e.unitSelectArr=e.preprocessData(s.data));case 4:case"end":return t.stop()}}),t)})))()},handleCascaderChange:function(){var e=this;this.authFrom.unit_id&&setTimeout((function(){var t=document.querySelector(".selectUnitInput input").value;t&&t.split("/")[2]&&(t=t.split("/")[2]||""),e.$confirm(t,"单位信息确认",{confirmButtonText:"确定",cancelButtonText:"取消",customClass:"topConfirm",closeOnClickModal:!1,type:"warning"}).then((function(){e.creatAuthCode({code:e.authFrom.code,area_id:e.authFrom.unit_id})})).catch((function(){e.authFrom.unit_id="",e.authFrom.sqm=""}))}),500)},getLicenseInfo:function(){var e=this;return Object(r["a"])(Object(i["a"])().mark((function t(){var s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(c["c"])();case 3:s=t.sent,200==s.code&&s.data&&s.data.surplusDay>0?(e.licenseInfo=s.data,e.authorized=!0):(e.licenseInfo={},e.authorized=!1,e.getUnitInfo(),e.getSystemInfo()),e.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},getSystemInfo:function(){var e=this;return Object(r["a"])(Object(i["a"])().mark((function t(){var s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["d"])();case 2:s=t.sent,200==s.code?e.authFrom.code=s.data:e.$message({message:"数据获取失败!",type:"warning"});case 4:case"end":return t.stop()}}),t)})))()},creatAuthCode:function(e){var t=this;return Object(r["a"])(Object(i["a"])().mark((function s(){var a;return Object(i["a"])().wrap((function(s){while(1)switch(s.prev=s.next){case 0:return s.next=2,Object(c["a"])(e);case 2:a=s.sent,200==a.code?t.authFrom.sqm=a.data:t.$message({type:"error",message:a.msg||"授权失败"});case 4:case"end":return s.stop()}}),s)})))()},confirmAuth:function(){var e=this;this.$refs.authLicenseForm.validate(function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(s){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!s){t.next=5;break}return t.next=3,Object(c["b"])({license:e.authLicenseForm.code});case 3:a=t.sent,200==a.code?(e.$message({type:"success",message:"授权成功"}),e.getLicenseInfo()):e.$message({type:"error",message:a.msg||"授权失败"});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},copyBtn:function(e){var t=document.createElement("textarea");t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.value=e,t.select();try{document.execCommand("copy"),this.$message.success("复制成功")}catch(s){this.$notify({type:"warning",title:"复制失败,请手动选择复制内容",dangerouslyUseHTMLString:!0,message:'<p style="white-space: normal; word-break: break-all;">'.concat(e,"</p>"),duration:5e3})}document.body.removeChild(t)},preprocessData:function(e){function t(e){e.subAreas&&e.subAreas.length?e.subAreas.forEach((function(e){t(e)})):delete e.subAreas}return e.forEach((function(e){t(e)})),e}}},u=l,d=(s("9a15"),s("f405"),s("2877")),m=Object(d["a"])(u,a,n,!1,null,"5de54052",null);t["default"]=m.exports},6933:function(e,t,s){},"9a15":function(e,t,s){"use strict";s("6933")},bb71:function(e,t,s){},cbcf:function(e,t,s){"use strict";s.d(t,"e",(function(){return n})),s.d(t,"d",(function(){return i})),s.d(t,"c",(function(){return r})),s.d(t,"b",(function(){return c})),s.d(t,"a",(function(){return o}));var a=s("b775");function n(){return Object(a["a"])({url:"/admin/area/all",method:"get"})}function i(){return Object(a["a"])({url:"/admin/license/systemInfo",method:"get"})}function r(){return Object(a["a"])({url:"/admin/license/query",method:"get"})}function c(e){return Object(a["a"])({url:"/admin/license/update",method:"put",data:e})}function o(e){return Object(a["a"])({url:"/admin/license/applicant/code",method:"post",data:e})}},f405:function(e,t,s){"use strict";s("bb71")}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-45b400ef"],{"2f54":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[a("el-card",{directives:[{name:"show",rawName:"v-show",value:!e.authorized,expression:"!authorized"}],scopedSlots:e._u([{key:"header",fn:function(){return[a("div",{staticClass:"clearfix"},[a("span",{staticStyle:{"line-height":"28px"}},[e._v("授权设置")]),a("div",{staticClass:"fr"},[a("el-button",{attrs:{size:"small",type:"info"},on:{click:function(t){return e.$router.push({path:"/"})}}},[e._v("返回首页")])],1)])]},proxy:!0}])},[a("el-form",{attrs:{size:"mini","label-width":"100px",model:e.authFrom,rules:e.rules}},[a("el-form-item",{attrs:{label:"SN 码:"}},[e._v(e._s(e.authFrom.code))]),a("el-form-item",{attrs:{label:"单位:",prop:"unit_id"}},[a("el-cascader",{staticClass:"selectUnitInput",staticStyle:{width:"100%"},attrs:{placeholder:"请选择单位","popper-class":"selectUnit",options:e.unitSelectArr,props:{label:"name",value:"id",children:"subAreas",emitPath:!1},filterable:""},on:{change:e.handleCascaderChange},model:{value:e.authFrom.unit_id,callback:function(t){e.$set(e.authFrom,"unit_id",t)},expression:"authFrom.unit_id"}})],1),a("el-form-item",{attrs:{prop:"sqm",label:"授权申请码"}},[a("el-input",{attrs:{placeholder:"选中单位自动获取申请码",type:"text",clearable:"","auto-complete":"off",size:"mini"},model:{value:e.authFrom.sqm,callback:function(t){e.$set(e.authFrom,"sqm","string"===typeof t?t.trim():t)},expression:"authFrom.sqm"}},[a("el-button",{attrs:{slot:"append",icon:"el-icon-copy-document"},on:{click:function(t){return e.copyBtn(e.authFrom.sqm)}},slot:"append"},[e._v("复制")])],1)],1)],1),a("el-form",{ref:"authLicenseForm",attrs:{size:"mini","label-width":"100px",model:e.authLicenseForm,rules:e.authLicenseFormRules}},[a("el-form-item",{attrs:{prop:"code",label:"授权码"}},[a("el-input",{attrs:{autosize:{minRows:5,maxRows:10},placeholder:"请输入授权码，授权码由授权申请码生成",type:"textarea",clearable:"","auto-complete":"off",size:"mini"},model:{value:e.authLicenseForm.code,callback:function(t){e.$set(e.authLicenseForm,"code","string"===typeof t?t.trim():t)},expression:"authLicenseForm.code"}})],1)],1),a("div",{staticClass:"flexCC"},[a("el-button",{attrs:{type:"success"},on:{click:e.confirmAuth}},[e._v("授权")])],1)],1),a("el-card",{directives:[{name:"show",rawName:"v-show",value:e.authorized,expression:"authorized"}],scopedSlots:e._u([{key:"header",fn:function(){return[a("div",{staticClass:"clearfix"},[a("span",{staticStyle:{"line-height":"28px"}},[e._v("授权信息")]),a("div",{staticClass:"fr"},[a("el-button",{attrs:{size:"small",type:"info"},on:{click:function(t){return e.$router.push({path:"/"})}}},[e._v("返回首页")])],1)])]},proxy:!0}])},[a("el-row",{attrs:{gutter:10}},[a("el-col",{attrs:{xs:12,sm:8,md:6}},[a("el-card",{staticClass:"licenItem"},[a("p",{staticClass:"i_title"},[e._v("版本")]),a("p",{staticClass:"i_value"},[e._v(e._s(e.licenseInfo.licenseVersion))])])],1),a("el-col",{attrs:{xs:12,sm:8,md:6}},[a("el-card",{staticClass:"licenItem"},[a("p",{staticClass:"i_title"},[e._v("地市")]),a("p",{staticClass:"i_value"},[e._v(e._s(e.licenseInfo.city))])])],1),a("el-col",{attrs:{xs:12,sm:8,md:6}},[a("el-card",{staticClass:"licenItem"},[a("p",{staticClass:"i_title"},[e._v("县区")]),a("p",{staticClass:"i_value"},[e._v(e._s(e.licenseInfo.area))])])],1),a("el-col",{attrs:{xs:12,sm:8,md:6}},[a("el-card",{staticClass:"licenItem"},[a("p",{staticClass:"i_title"},[e._v("单位名称")]),a("p",{staticClass:"i_value"},[e._v(e._s(e.licenseInfo.unit))])])],1),a("el-col",{attrs:{xs:12,sm:8,md:6}},[a("el-card",{staticClass:"licenItem"},[a("p",{staticClass:"i_title"},[e._v("开始时间")]),a("p",{staticClass:"i_value"},[e._v(e._s(e.parseTime(e.licenseInfo.startTime)))])])],1),a("el-col",{attrs:{xs:12,sm:8,md:6}},[a("el-card",{staticClass:"licenItem"},[a("p",{staticClass:"i_title"},[e._v("截止时间")]),a("p",{staticClass:"i_value"},[e._v(e._s(e.parseTime(e.licenseInfo.endTime)))])])],1),a("el-col",{attrs:{xs:12,sm:8,md:6}},[a("el-card",{staticClass:"licenItem"},[a("p",{staticClass:"i_title"},[e._v("授权天数")]),a("p",{staticClass:"i_value"},[e._v(e._s(e.licenseInfo.licenseDay))])])],1),a("el-col",{attrs:{xs:12,sm:8,md:6}},[a("el-card",{staticClass:"licenItem"},[a("p",{staticClass:"i_title"},[e._v("剩余天数")]),a("p",{staticClass:"i_value"},[e._v(e._s(e.licenseInfo.surplusDay))])])],1)],1)],1)],1)},n=[],i=a("c7eb"),r=a("1da1"),c=(a("d3b7"),a("159b"),a("cbcf")),o=a("ed08"),l={data:function(){return{loading:!1,authorized:!0,licenseInfo:{},authFrom:{code:"",unit_id:"",sqm:""},authLicenseForm:{code:""},unitSelectArr:[],rules:{unit_id:[{required:!0,message:"单位不能为空",trigger:"blur"}]},authLicenseFormRules:{code:[{required:!0,message:"授权码不能为空",trigger:"blur"}],sqm:[{required:!0,message:"授权申请码不能为空",trigger:"blur"}]}}},mounted:function(){this.getLicenseInfo()},methods:{parseTime:o["b"],getUnitInfo:function(){var e=this;return Object(r["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["e"])();case 2:a=t.sent,200==a.code&&(e.unitSelectArr=e.preprocessData(a.data));case 4:case"end":return t.stop()}}),t)})))()},handleCascaderChange:function(){var e=this;this.authFrom.unit_id&&setTimeout((function(){var t=document.querySelector(".selectUnitInput input").value;t&&t.split("/")[2]&&(t=t.split("/")[2]||""),e.$confirm(t,"单位信息确认",{confirmButtonText:"确定",cancelButtonText:"取消",customClass:"topConfirm",closeOnClickModal:!1,type:"warning"}).then((function(){e.creatAuthCode({code:e.authFrom.code,area_id:e.authFrom.unit_id})})).catch((function(){e.authFrom.unit_id="",e.authFrom.sqm=""}))}),500)},getLicenseInfo:function(){var e=this;return Object(r["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return e.loading=!0,t.next=3,Object(c["c"])();case 3:a=t.sent,200==a.code?(e.licenseInfo=a.data,e.authorized=!0):(e.licenseInfo={},e.authorized=!1,e.getUnitInfo(),e.getSystemInfo()),e.loading=!1;case 6:case"end":return t.stop()}}),t)})))()},getSystemInfo:function(){var e=this;return Object(r["a"])(Object(i["a"])().mark((function t(){var a;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,Object(c["d"])();case 2:a=t.sent,200==a.code?e.authFrom.code=a.data:e.$message({message:"数据获取失败!",type:"warning"});case 4:case"end":return t.stop()}}),t)})))()},creatAuthCode:function(e){var t=this;return Object(r["a"])(Object(i["a"])().mark((function a(){var s;return Object(i["a"])().wrap((function(a){while(1)switch(a.prev=a.next){case 0:return a.next=2,Object(c["a"])(e);case 2:s=a.sent,200==s.code?t.authFrom.sqm=s.data:t.$message({type:"error",message:s.msg||"授权失败"});case 4:case"end":return a.stop()}}),a)})))()},confirmAuth:function(){var e=this;this.$refs.authLicenseForm.validate(function(){var t=Object(r["a"])(Object(i["a"])().mark((function t(a){var s;return Object(i["a"])().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=5;break}return t.next=3,Object(c["b"])({license:e.authLicenseForm.code});case 3:s=t.sent,200==s.code?(e.$message({type:"success",message:"授权成功"}),e.getLicenseInfo()):e.$message({type:"error",message:s.msg||"授权失败"});case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},copyBtn:function(e){var t=document.createElement("textarea");t.style.position="absolute",t.style.left="-9999px",document.body.appendChild(t),t.value=e,t.select();try{document.execCommand("copy"),this.$message.success("复制成功")}catch(a){this.$notify({type:"warning",title:"复制失败,请手动选择复制内容",dangerouslyUseHTMLString:!0,message:'<p style="white-space: normal; word-break: break-all;">'.concat(e,"</p>"),duration:5e3})}document.body.removeChild(t)},preprocessData:function(e){function t(e){e.subAreas&&e.subAreas.length?e.subAreas.forEach((function(e){t(e)})):delete e.subAreas}return e.forEach((function(e){t(e)})),e}}},u=l,d=(a("faab"),a("e20a"),a("2877")),m=Object(d["a"])(u,s,n,!1,null,"76bf6ed0",null);t["default"]=m.exports},cbcf:function(e,t,a){"use strict";a.d(t,"e",(function(){return n})),a.d(t,"d",(function(){return i})),a.d(t,"c",(function(){return r})),a.d(t,"b",(function(){return c})),a.d(t,"a",(function(){return o}));var s=a("b775");function n(){return Object(s["a"])({url:"/admin/area/all",method:"get"})}function i(){return Object(s["a"])({url:"/admin/license/systemInfo",method:"get"})}function r(){return Object(s["a"])({url:"/admin/license/query",method:"get"})}function c(e){return Object(s["a"])({url:"/admin/license/update",method:"put",data:e})}function o(e){return Object(s["a"])({url:"/admin/license/applicant/code",method:"post",data:e})}},e20a:function(e,t,a){"use strict";a("eeb3")},ecf2:function(e,t,a){},eeb3:function(e,t,a){},faab:function(e,t,a){"use strict";a("ecf2")}}]);
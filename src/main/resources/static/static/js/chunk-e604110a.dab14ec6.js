(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e604110a"],{"24b4":function(t,e,a){"use strict";a.d(e,"d",(function(){return s})),a.d(e,"e",(function(){return n})),a.d(e,"a",(function(){return r})),a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return c}));var i=a("b775");function s(t){return Object(i["a"])({url:"/admin/gather/type",method:"get",params:t})}function n(t){return Object(i["a"])({url:"/admin/gather/main",method:"get",params:t})}function r(t){return Object(i["a"])({url:"/admin/sureying/log",method:"get",params:t})}function o(t){return Object(i["a"])({url:"/admin/sureying/log/single/segment",method:"get",params:t})}function c(t){return Object(i["a"])({url:"/admin/gather/log/status",method:"get",params:t})}},"3bb4":function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("el-card",{scopedSlots:t._u([{key:"header",fn:function(){return[a("div",{staticClass:"clearfix"},[a("span",{staticStyle:{"line-height":"28px"}},[t._v("测绘日志")]),a("div",{staticClass:"fr"},[a("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.handBtn}},[a("span",[t._v("开始测绘")])]),a("el-button",{directives:[{name:"show",rawName:"v-show",value:!t.noTestRow,expression:"!noTestRow"}],attrs:{size:"small",type:"success"},on:{click:function(e){t.viewDialogFlag=!0}}},[t._v("测绘结果")])],1)])]},proxy:!0}])},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.startLoading,expression:"startLoading"}],staticClass:"logWrap fz12"},[t._l(t.logList,(function(e){return a("div",{key:e.id,staticClass:"logItem flexBox"},[a("div",{staticClass:"logContent"},[a("div",{staticClass:"logMsg"},[a("p",[t._v(t._s(e.name))]),a("div",{staticClass:"time"},[a("span",[t._v(t._s(e.beginTime))]),t._v(" ~ "),a("span",[a("span",{directives:[{name:"show",rawName:"v-show",value:1===e.status,expression:"item.status === 1"}],staticClass:"successC"},[a("i",{staticClass:"el-icon-loading"}),a("span",{staticClass:"fz12"},[t._v(t._s("数据上传"===e.name?"数据上传中...":"分析中..."))])]),t._v(" "+t._s(e.endTime)+" ")])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:2===e.status,expression:"item.status === 2"}],staticClass:"dot green"},[t._v("成功")]),a("div",{directives:[{name:"show",rawName:"v-show",value:3===e.status,expression:"item.status === 3"}],staticClass:"dot red"},[t._v("失败")])]),a("div",{staticClass:"actions"})])})),a("div",{directives:[{name:"show",rawName:"v-show",value:!t.isRunning&&t.logList.length,expression:"!isRunning && logList.length"}],staticClass:"logItem flexBox"},[a("div",{staticClass:"logContent"},[a("div",{staticClass:"logMsg"},[a("p",[t._v("测绘完成")])])])])],2),a("el-dialog",{attrs:{"close-on-click-modal":!1,title:"测绘结果","custom-class":"mw600 smTank",visible:t.viewDialogFlag,width:"80%",top:"20%"},on:{"update:visible":function(e){t.viewDialogFlag=e},open:t.getAsyncList}},[a("div",{directives:[{name:"loading",rawName:"v-loading",value:t.detailIsLoading,expression:"detailIsLoading"}]},[a("fieldset",{staticClass:"m-b-10"},[a("legend",[t._v("终端统计")]),a("el-descriptions",{staticClass:"fz12",attrs:{column:1}},[a("el-descriptions-item",{attrs:{label:"IPv4终端"}},[t._v(t._s(t.rowDetail.ipv4))]),a("el-descriptions-item",{attrs:{label:"IPv4/IPv6终端"}},[t._v(t._s(t.rowDetail.ipv4_ipv6))])],1)],1)])])],1)},s=[],n=a("c7eb"),r=a("1da1"),o=(a("4de4"),a("d3b7"),a("24b4")),c=a("ae6f"),u={props:{configList:{type:Array,default:function(){return[]}}},data:function(){return{noTestRow:!1,viewTablePost:{currentPage:1,pageSize:15},isRunning:!1,startLoading:!1,logTimer:null,logList:[],viewDialogFlag:!1,defaultProps:{children:"subnetList",label:"ip"},detailIsLoading:!1,rowDetail:{result:"",ipv4:"",ipv4_ipv6:"",subme_ipv4:[],subme_ipv6:[],gatewayInfo:[]}}},watch:{configList:{handler:function(t){var e=this.configList.filter((function(t){return 1==t.deviceVendorSequence}));this.noTestRow=e.length>0,console.log(this.noTestRow)},deep:!0}},computed:{v4v6Ratio:function(){var t=this.rowDetail.ipv4,e=this.rowDetail.ipv4_ipv6;return t||e?t+e>=30?e/(t+e)>=.5:e/(t+e)>=.7:-1}},mounted:function(){this.getCaiJiStatus(),this.getAsyncList()},methods:{getCaiJiStatus:function(){var t=this;return Object(r["a"])(Object(n["a"])().mark((function e(){var a,i;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["e"])({type:1});case 2:if(a=e.sent,200!==a.code){e.next=10;break}if(1001!==a.data){e.next=10;break}return e.next=7,Object(o["a"])();case 7:i=e.sent,200==i.code&&i.data&&(t.logList=i.data.data),t.isRunning=!1;case 10:1002===a.code&&(t.isRunning=!0,t.getLogList());case 11:case"end":return e.stop()}}),e)})))()},handBtn:function(){var t=this;return Object(r["a"])(Object(n["a"])().mark((function e(){return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!t.isRunning){e.next=2;break}return e.abrupt("return",t.$message({message:"正在采集中... 请勿重复提交",type:"warning"}));case 2:Object(o["e"])().then((function(e){if(200!=e.code)return t.$message({message:e.msg,type:"warning"})})),setTimeout((function(){t.getCaiJiStatus()}),500);case 4:case"end":return e.stop()}}),e)})))()},getLogList:function(){var t=this;return Object(r["a"])(Object(n["a"])().mark((function e(){var a;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(o["a"])();case 2:if(a=e.sent,200!=a.code||!a.data){e.next=13;break}if(t.logList=a.data.data,!a.data.finish){e.next=10;break}return t.isRunning=!1,e.abrupt("return");case 10:t.isRunning=!0,t.logTimer&&clearTimeout(t.logTimer),t.logTimer=setTimeout((function(){t.getLogList()}),2e3);case 13:t.startLoading=!1;case 14:case"end":return e.stop()}}),e)})))()},getAsyncList:function(){var t=this;return Object(r["a"])(Object(n["a"])().mark((function e(){var a,i,s;return Object(n["a"])().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.detailIsLoading=!0,e.next=3,Object(c["a"])(t.viewTablePost);case 3:a=e.sent,200==a.code&&a.data&&(i=a.data.obj[0]||{},s=i.details&&"string"===typeof i.details?JSON.parse(i.details):{},t.rowDetail.result=i.result,t.rowDetail.ipv4=s.ipv4,t.rowDetail.ipv4_ipv6=s.ipv4_ipv6,t.rowDetail.subme_ipv4=s.subme_ipv4&&"string"===typeof s.subme_ipv4?JSON.parse(s.subme_ipv4):[],t.rowDetail.subme_ipv6=s.subme_ipv6&&"string"===typeof s.subme_ipv6?JSON.parse(s.subme_ipv6):[],t.rowDetail.gatewayInfo=s.gatewayInfo),t.detailIsLoading=!1;case 6:case"end":return e.stop()}}),e)})))()}}},l=u,d=(a("63a4"),a("2877")),g=Object(d["a"])(l,i,s,!1,null,"d37d8f22",null);e["default"]=g.exports},"63a4":function(t,e,a){"use strict";a("bf43")},ae6f:function(t,e,a){"use strict";a.d(e,"a",(function(){return s}));var i=a("b775");function s(t){return Object(i["a"])({url:"/admin/gather/log/list",method:"post",data:t})}},bf43:function(t,e,a){}}]);